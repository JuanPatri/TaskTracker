@page "/ViewTaskFromProyect/{projectId:int}"
@using Backend.Domain
@using Backend.Service
@inject ProjectService ProjectService

<h3>View Tasks from project: @projectName</h3>

@if (project == null)
{
    <p class="text-danger">Project not found.</p>
}
else if (project.Tasks.Count == 0)
{
    <p>No tasks found for this project.</p>
}
else
{
    <table class="table table-bordered table-striped">
        <thead>
        <tr>
            <th>Title</th>
            <th>Duration (days)</th>
            <th>Status</th>
            <th>Early Start</th>
            <th>Early Finish</th>
            <th>Late Start</th>
            <th>Late Finish</th>
        </tr>
        </thead>
        <tbody>
        @foreach (var task in project.Tasks)
        {
            <tr>
                <td>@task.Title</td>
                <td>@task.Duration</td>
                <td>@task.Status</td>
                <td>@task.EarlyStart.ToShortDateString()</td>
                <td>@task.EarlyFinish.ToShortDateString()</td>
                <td>@task.LateStart.ToShortDateString()</td>
                <td>@task.LateFinish.ToShortDateString()</td>
            </tr>
        }
        </tbody>
    </table>
}

@code {
    [Parameter]
    public int projectId { get; set; }

    private Project? project;
    private string projectName = "";

    protected override void OnParametersSet()
    {
        project = ProjectService.GetProjectById(projectId);

        if (project != null)
        {
            ProjectService.CalculateLateTimes(project);
            projectName = project.Name;
            
        }
    }
}
